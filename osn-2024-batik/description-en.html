<!-- Title: Betawi Batik -->

<h3>Description</h3>

<p>
  Pak Dengklek is deeply interested in <em>batik</em>, a traditional Indonesian cloth.
  One day, Pak Dengklek discovered a magical batik cloth from Betawi.
</p>
<p>
  The batik cloth has a rectangular shape divided into squares with $N$ rows and $M$ columns.
  The rows are numbered from $1$ to $N$ from top to bottom.
  The columns are numbered from $1$ to $M$ from left to right.
  Let $(r, c)$ denote the square at row $r$ and column $c$.
</p>
<p>
  There are $N \times M$ distinct colors on the cloth.
  These colors are numbered from $0$ to $N \times M - 1$.
  Initially, square $(i, j)$ has color $A_{i,j}$ for each $1 \leq i \leq N$; $1 \leq j \leq M$ and it is known that no two squares share the same color.
</p>
<p>
  Since the batik cloth is magical, Pak Dengklek can perform several modifications to the colors on this cloth.
  There will be $Q$ events.
  Each event is one of the following three types:
</p>
<ul>
  <li>
    <code>1 R<sub>1</sub> C<sub>1</sub> R<sub>2</sub> C<sub>2</sub></code> &mdash;
    Squares $(R_1, C_1)$ and $(R_2, C_2)$ swap colors.
  </li>
  <li>
    <code>2 W</code> &mdash;
    Each square changes color from color $x$ to color $(x + W) \bmod (N \times M)$.
    Note: $p \bmod q$ denotes the remainder of dividing $p$ with $q$.
  </li>
  <li>
    <code>3 R<sub>1</sub> C<sub>1</sub> R<sub>2</sub> C<sub>2</sub></code> &mdash;
    Pak Dengklek asks: what is the color with the smallest number that does not appear on all squares $(r, c)$ that satisfy $R_1 \leq r \leq R_2$; $C_1 \leq c \leq C_2$?
  </li>
</ul>
<p>
  Help Pak Dengklek answer all his questions!
</p>

<h3>Constraints</h3>

<ul>
  <li>$1 \leq N, M \leq 500$</li>
  <li>$0 \leq A_{i,j} \leq N \times M - 1$</li>
  <li>No two squares share the same color initially.</li>
  <li>$1 \leq Q \leq 100\,000$</li>
  <li>For each event of type 1, $1 \leq R_1, R_2 \leq N$; $1 \leq C_1, C_2 \leq M$; $(R_1, C_1) \neq (R_2, C_2)$.</li>
  <li>For each event of type 2, $1 \leq W \leq N \times M - 1$.</li>
  <li>For each event of type 3, $1 \leq R_1 \leq R_2 \leq N$; $1 \leq C_1 \leq C_2 \leq M$.</li>
  <li>There is at least one event of type 3.</li>
</ul>

<h3>Subtasks</h3>

<ol>
  <li>&nbsp;&nbsp;(9 points) There are at most $10$ events of type 2 and at most $10$ events of type 3.</li>
  <li>(10 points) There are at most $10$ events of type 3.</li>
  <li>(15 points) There are no events of type 2; for each event of type 3, it is guaranteed that $(R_1, C_1, R_2, C_2) = (1, 1, \lceil\frac{N}{2}\rceil, M)$.</li>
  <li>&nbsp;&nbsp;(8 points) For each event of type 3, it is guaranteed that $(R_1, C_1, R_2, C_2) = (1, 1, \lceil\frac{N}{2}\rceil, M)$.</li>
  <li>(28 points) There are no events of types 1 and 2.</li>
  <li>(23 points) There are no events of type 2.</li>
  <li>&nbsp;&nbsp;(7 points) No additional constraints.</li>
</ol>

<h3>Input</h3>

<p>
  The input is given in the following format:
</p>
<pre>
N M
A<sub>1,1</sub> A<sub>1,2</sub> &hellip; A<sub>1,M</sub>
A<sub>2,1</sub> A<sub>2,2</sub> &hellip; A<sub>2,M</sub>
&vellip;        &#x22f1; &vellip;
A<sub>N,1</sub> A<sub>N,2</sub> &hellip; A<sub>N,M</sub>
Q
event<sub>1</sub>
event<sub>2</sub>
&vellip;
event<sub>Q</sub>
</pre>

<h3>Output</h3>

<p>
  For each event of type 3, output a single line containing an integer representing the smallest color number that does not appear on all squares $(r, c)$ satisfying $R_1 \leq r \leq R_2$; $C_1 \leq c \leq C_2$.
  Specifically, if all colors appear, output <code>-1</code>.
</p>

<h3>Sample Input</h3>

<pre>
4 3
11 10 9
2 6 7
1 5 0
3 8 4
6
3 2 1 3 3
1 2 3 1 2
2 7
3 1 2 4 2
3 1 1 4 3
3 4 1 4 1
</pre>

<h3>Sample Output</h3>

<pre>
3
4
-1
0
</pre>

<h3>Explanation of Sample</h3>

<p>
  Initially, the batik cloth is shaped as follows:
</p>
<p>
  <img src="render/batikbetawi.png" style="width: 200px;">
</p>
<p>
  The $1$-st event queries the following cloth section:
</p>
<p>
  <img src="render/batikbetawi2.png" style="width: 200px;">
</p>
<ul>
  <li>The smallest color number that does not appear is $3$.</li>
</ul>
<p>
  After the $2$-nd event, the batik cloth changes to as follows:
</p>
<p>
  <img src="render/batikbetawi3.png" style="width: 200px;">
</p>
<p>
  After the $3$-rd event, the batik cloth changes to as follows:
</p>
<p>
  <img src="render/batikbetawi4.png" style="width: 200px;">
</p>
<p>
  The $4$-th, $5$-th, and $6$-th events query the following cloth sections:
</p>
<p>
  <img src="render/batikbetawi5.png" style="width: 200px;">
</p>
<ul>
  <li>For the $4$-th event, the smallest color number that does not appear is $4$.</li>
  <li>For the $5$-th event, all colors appear, thus we output <code>-1</code>.</li>
  <li>For the $6$-th event, the smallest color number that does not appear is $0$.</li>
</ul>